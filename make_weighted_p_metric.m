function metric_handle = make_weighted_p_metric(x_w, y_w, p)
    metric_handle = @(x, y) ( ...
        (abs(x)*x_w).^p + (abs(y)*y_w).^p...
        ).^(1/p);
end